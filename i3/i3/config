# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

exec_always "/usr/bin/xrandr --dpi 150"
# exec_always "/usr/bin/xrandr --dpi 100"
set $mod Mod4

# Font
font pango:DejaVu Sans Mono Bold 7
new_window 1pixel

# Scratchpad
bindsym $mod+Control+Shift+minus move scratchpad
bindsym $mod+Control+minus scratchpad show
# Toggle tiling / floating
bindsym $mod+Shift+space floating toggle
# Change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# Go to previous workspace/screen
bindsym $mod+o workspace back_and_forth
bindsym $mod+Shift+o move container to workspace back_and_forth
bindsym $mod+Control+o move container to workspace 1; workspace back_and_forth

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# Start a terminal
bindsym $mod+Return exec kitty --config ~/.kitty.conf
# bindsym $mod+Return exec termite
bindsym $mod+Control+Shift+Return exec kitty --config ~/.kitty.conf -e tmux
# bindsym $mod+Shift+Return exec gnome-terminal
# bindsym $mod+Control+Shift+Return exec gnome-terminal -e "nvim -u ~/.nvimrc_terminal -c 'terminal bash --rcfile ~/.bashrc_neovim'"
# bindsym $mod+s exec stterm
# bindsym $mod+Shift+s exec stterm -e tmux
# bindsym $mod+Control+Shift+s exec stterm -e bash -c 'nvim -u ~/.nvimrc_terminal -c ter'

# Split terminal in same working directory
bindsym --release Mod1+g split v; exec xdotool key --clearmodifiers alt+Return
bindsym --release Mod1+v split h; exec xdotool key --clearmodifiers alt+Return

# Edit dotfiles
bindsym $mod+Control+Shift+a exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/install ~/dotfiles/apt-installs'
bindsym $mod+Control+Shift+b exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/bash/bashrc ~/dotfiles/bash/bashrc_neovim'
bindsym $mod+Control+Shift+c exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/bin/conf'
bindsym $mod+Control+Shift+d exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/digraphs'
bindsym $mod+Control+Shift+e exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'xclip -o | nvim -u ~/dotfiles/nvim/nvimrc_clipboard'
bindsym $mod+Control+Shift+f exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/tridactyl/tridactylrc'
#       $mod+Control+Shift+g taken
bindsym $mod+Control+Shift+h exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim $(xclip -o)'
bindsym $mod+Control+Shift+i exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/i3/i3/config ~/dotfiles/i3/i3status.conf ~/dotfiles/bin/i3status_custom.sh'
bindsym $mod+Control+Shift+j exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/judo'
bindsym $mod+Control+Shift+k exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/kitty/kitty.conf'
#       $mod+Control+Shift+l free
#       $mod+Control+Shift+m taken
#       $mod+Control+Shift+n taken
#       $mod+Control+Shift+o taken
bindsym $mod+Control+Shift+p exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/nato'
#       $mod+Control+Shift+q taken
bindsym $mod+Control+Shift+r exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/Documents/resume/James_Blau_Resume.markdown ~/Documents/resume/style.css'
#       $mod+Control+Shift+s free
bindsym $mod+Control+Shift+t exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/tmux/tmux.conf'
bindsym $mod+Control+Shift+u exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/.muttrc'
bindsym $mod+Control+Shift+v exec kitty --config ~/.kitty.conf bash --rcfile ~/.bashrc -c 'nvim ~/dotfiles/vim/vimrc ~/dotfiles/vim/vimrc.bundles ~/dotfiles/nvim/nvimrc ~/dotfiles/page/pagerc ~/dotfiles/nvim/nvimrc_terminal ~/dotfiles/nvim/nvimrc_clipboard'
#       $mod+Control+Shift+w free
#       $mod+Control+Shift+x free
#       $mod+Control+Shift+y free
#       $mod+Control+Shift+z free

# Re-run conf; why does 'setxkbmap -option ctrl:nocaps' run more slowly in kitty?
bindsym $mod+BackSpace exec kitty --config ~/.kitty.conf bash -c ~/bin/conf
# bindsym $mod+BackSpace exec gnome-terminal -e 'bash -c ~/bin/conf'

# Open directories
bindsym $mod+Control+Shift+o exec kitty --config ~/.kitty.conf --directory='~/Downloads'

# Open programs
# bindsym $mod+u exec kitty --config ~/.kitty.conf mutt

# Audio shortcuts
bindsym $mod+Shift+p exec pavucontrol
bindsym $mod+Control+Shift+n exec toggle_sleep_noise

# Thinkpad buttons
bindsym $mod+F1 exec "amixer -D pulse set Master toggle; killall -USR1 i3status"
bindsym $mod+F2 exec "pactl set-sink-volume 0 -5%; killall -USR1 i3status"
bindsym $mod+F3 exec "pactl set-sink-volume 0 +5%; killall -USR1 i3status"
bindsym $mod+Control+F2 exec "pactl set-sink-volume 0 -1%; killall -USR1 i3status"
bindsym $mod+Control+F3 exec "pactl set-sink-volume 0 +1%; killall -USR1 i3status"
bindsym $mod+F4 exec "amixer -D pulse set Capture toggle; killall -USR1 i3status"
bindsym $mod+Shift+F2 exec "amixer -D pulse set Capture 5%-; killall -USR1 i3status"
bindsym $mod+Shift+F3 exec "amixer -D pulse set Capture 5%+; killall -USR1 i3status"
bindsym $mod+F5 exec "light -U 20"
bindsym $mod+F6 exec "light -A 20"
bindsym $mod+Shift+F5 exec "light -S 0"
bindsym $mod+Shift+F6 exec "light -S 100"

# TODO: Some of these?
# 173 XF86AudioPrev
# 172 XF86AudioPlay
# 171 XF86AudioNext
# 122 XF86AudioLowerVolume
# 123 XF86AudioRaiseVolume
# 121 XF86AudioMute
# 198 XF86AudioMicMute
# 232 XF86MonBrightnessDown
# 233 XF86MonBrightnessUp
# 235 XF86Display
# 246 XF86WLAN
# 179 XF86Tools
# 245 XF86Bluetooth

# Kill focused window
bindsym $mod+Control+Shift+F4 kill

# Start dmenu
bindsym $mod+d exec dmenu_run -nb '#1f1f1f' -sb '#87AFAF' -sf '#1f1f1f' -fn hack
# Only displays applications shipping a .desktop file
# bindsym $mod+d exec --no-startup-id i3-dmenu-desktop

# Change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# Split in horizontal orientation, yes I know it says 'v'
bindsym $mod+g split v

# Split in vertical orientation, yes I know it says 'h'
bindsym $mod+v split h

# Enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# Change container layout (stacked, tabbed, toggle split)
bindsym $mod+q layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Focus the parent container
bindsym $mod+p focus parent

# Focus the child container
bindsym $mod+n focus child

# Switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# Move focused container to workspace and go there
bindsym $mod+Control+1 move container to workspace 1; workspace 1
bindsym $mod+Control+2 move container to workspace 2; workspace 2
bindsym $mod+Control+3 move container to workspace 3; workspace 3
bindsym $mod+Control+4 move container to workspace 4; workspace 4
bindsym $mod+Control+5 move container to workspace 5; workspace 5
bindsym $mod+Control+6 move container to workspace 6; workspace 6
bindsym $mod+Control+7 move container to workspace 7; workspace 7
bindsym $mod+Control+8 move container to workspace 8; workspace 8
bindsym $mod+Control+9 move container to workspace 9; workspace 9
bindsym $mod+Control+0 move container to workspace 10; workspace 10

# Move parent container to workspace and go there
bindsym $mod+Control+Shift+1 focus parent; move container to workspace 1; workspace 1
bindsym $mod+Control+Shift+2 focus parent; move container to workspace 2; workspace 2
bindsym $mod+Control+Shift+3 focus parent; move container to workspace 3; workspace 3
bindsym $mod+Control+Shift+4 focus parent; move container to workspace 4; workspace 4
bindsym $mod+Control+Shift+5 focus parent; move container to workspace 5; workspace 5
bindsym $mod+Control+Shift+6 focus parent; move container to workspace 6; workspace 6
bindsym $mod+Control+Shift+7 focus parent; move container to workspace 7; workspace 7
bindsym $mod+Control+Shift+8 focus parent; move container to workspace 8; workspace 8
bindsym $mod+Control+Shift+9 focus parent; move container to workspace 9; workspace 9
bindsym $mod+Control+Shift+0 focus parent; move container to workspace 10; workspace 10

# Move between monitors
bindsym $mod+m focus output left; focus output up
bindsym $mod+Control+m move workspace to output left; move workspace to output up
bindsym $mod+Shift+m move container to output left; move container to output up
bindsym $mod+Control+Shift+m move container to output left; move container to output up; focus output left; focus output up

# Reload the configuration file
bindsym $mod+Shift+c reload
# Restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# Exit i3 (logs you out of your X session)
bindsym $mod+Control+Shift+Delete exec sh -c '[ $(echo "NO\nYES" | dmenu -sb "#a8551e" -i -p "Really exit i3 X session?") = "YES" ] && i3-msg exit'
# bindsym $mod+Shift+w exec sh -c 'xset dpms force standby'
# bindsym $mod+F5 exec sh -c 'sleep 1 && xset dpms force standby'
# bindsym $mod+Shift+w exec gnome-terminal -e "xset dpms force standby"

mode "resize" {
  bindsym u resize grow left 50 px or 50 ppt
  bindsym i resize grow down 50 px or 50 ppt
  bindsym o resize grow up 50 px or 50 ppt
  bindsym p resize grow right 50 px or 50 ppt
  bindsym Shift+u resize shrink right 50 px or 50 ppt
  bindsym Shift+i resize shrink up 50 px or 50 ppt
  bindsym Shift+o resize shrink down 50 px or 50 ppt
  bindsym Shift+p resize shrink left 50 px or 50 ppt

  bindsym h resize grow left 5 px or 5 ppt
  bindsym j resize grow down 5 px or 5 ppt
  bindsym k resize grow up 5 px or 5 ppt
  bindsym l resize grow right 5 px or 5 ppt
  bindsym Shift+h resize shrink right 5 px or 5 ppt
  bindsym Shift+j resize shrink up 5 px or 5 ppt
  bindsym Shift+k resize shrink down 5 px or 5 ppt
  bindsym Shift+l resize shrink left 5 px or 5 ppt

  bindsym Control+h resize grow left 1 px or 1 ppt
  bindsym Control+j resize grow down 1 px or 1 ppt
  bindsym Control+k resize grow up 1 px or 1 ppt
  bindsym Control+l resize grow right 1 px or 1 ppt
  bindsym Control+Shift+h resize shrink right 1 px or 1 ppt
  bindsym Control+Shift+j resize shrink up 1 px or 1 ppt
  bindsym Control+Shift+k resize shrink down 1 px or 1 ppt
  bindsym Control+Shift+l resize shrink left 1 px or 1 ppt

  bindsym Return mode "default"
  bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"

# Colors
# class                 border  backgr. text    indicator child_border
client.focused          #4c7899 #87AFAF #1f1f1f #2e9ef4   #87AFAF
client.focused_inactive #333333 #5f676a #1f1f1f #484e50   #5f676a
client.unfocused        #333333 #222222 #888888 #292d2e   #222222
client.urgent           #2f343a #9e2222 #1f1f1f #900000   #900000
client.placeholder      #000000 #0c0c0c #1f1f1f #000000   #0c0c0c

client.background       #1f1f1f

# Start i3bar to display a workspace bar (plus the system information i3status finds out, if available)
bar {
  #i3bar_command ~/src/opensource/S0lll0s/i3bgbar/i3bar/i3bar

  #status_command python /usr/local/lib/python2.7/dist-packages/powerline/bindings/i3/powerline-i3.py

  status_command ~/bin/i3status_custom.sh
  #status_command i3status
  #status_command i3status | ~/scripts/status/status.pl
  font pango:DejaVu Sans Mono 11
  tray_output eDP-1
  tray_output eDP-1-1
  tray_output LVDS-1
  tray_output LVDS-2
  colors {
    background #1f1f1f
    statusline #87AFAF
    separator #87AFAF

    # class            border  backgr. text
    focused_workspace  #87AFAF #87AFAF #1f1f1f
    active_workspace   #333333 #5f676a #1f1f1f
    inactive_workspace #333333 #222222 #888888
    urgent_workspace   #2f343a #9e2222 #1f1f1f
  }
}

# Startup things...
exec_always sudo ~/bin/conf
exec_always ~/bin/lid-lock
exec clipit
exec nm-applet
# exec blueman-applet
# exec volti
# exec udisks-glue
# exec udiskie

# Strip trailing newline from clipboard
bindsym $mod+i exec ~/bin/strip_whitespace
bindsym $mod+Shift+i exec ~/bin/strip_whitespace -l
bindsym $mod+Control+i exec ~/bin/strip_whitespace -a
bindsym $mod+Mod1+i exec ~/bin/strip_whitespace -s

# Not sure about this one
focus_follows_mouse no

# This is the clever part
bindsym $mod+F9 exec "echo -n '¯\_(ツ)_/¯' | xclip"
bindsym $mod+F10 exec "echo -n '¯\_(⊙︿⊙)_/¯' | xclip"
bindsym $mod+F11 exec "echo -n 'ಥ_ಥ' | xclip"
bindsym $mod+F12 exec "echo -n 'ಠ_ಠ' | xclip"
bindsym $mod+Shift+F9 exec "echo -n '(╯°□°)╯︵ ┻━┻' | xclip"
bindsym $mod+Shift+F10 exec "echo -n '( ͡° ͜ʖ ͡°)' | xclip"
bindsym $mod+Shift+F11 exec "echo -n '(•_•)\n( •_•)>⌐■-■\n(⌐■_■)' | xclip"
bindsym $mod+Shift+F12 exec "echo -n '☃' | xclip"

# Slightly easier caret mode
bindsym --release Control+7 exec xdotool key --clearmodifiers F7

# Firefox popups
for_window [title="Alarm - Mozilla Firefox"] floating enable,move absolute center,move workspace current

# Firefox disable Control+Q
bindsym Control+q exec ~/bin/noctrlq.sh

# Fix wifi TODO: Somehow obviate need for this
bindsym $mod+F8 exec kitty --config ~/.kitty.conf bash -c reset_network_manager_and_vpn
bindsym $mod+Control+F8 exec kitty --config ~/.kitty.conf bash -c kill_vpn_and_reset_network_manager
bindsym $mod+Control+Shift+F8 exec kitty --config ~/.kitty.conf bash -c toggle_vpn

# Firefox failed
# bindsym $mod+Control+Shift+g exec "chromium-browser $(xclip -o)"
bindsym $mod+Control+Shift+g exec "google-chrome-stable $(xclip -o)"
bindsym $mod+Control+Shift+q exec "qutebrowser $(xclip -o)"

# TODO: For git d: if there is only one monitor, open a split, otherwise open a scratchpad on the other monitor

# vim:filetype=conf
